<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POP.Game</title>

    <link rel="stylesheet" href="https://unpkg.com/swiper@8/swiper-bundle.min.css" />
    <!-- font awesome cdn link -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- custom css file link -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/css/allStyle.css">
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/css/style.css">
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/css/headerStyle.css">
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/css/footerStyle.css">


    <!-- Favicon -->
    <link rel="shortcut icon" href="/CGA101G1/frontend/mainCss/images/logo.png">
    <!-- Fonts CSS -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/assets/vendor/fonts/fonts.css">
    <!-- Bootstrap-icons CSS -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/assets/vendor/bootstrap/icons/bootstrap-icons.css">
    <!--Magnific-Popup CSS -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/assets/vendor/magnific/magnific-popup.css">
    <!-- Slick CSS -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/assets/vendor/slick/slick.css">
    <!-- Style CSS -->
    <link rel="stylesheet" href="/CGA101G1/frontend/mainCss/assets/css/style01.css">
</head>

<body>

    <!-- header section starts-->

    <header>

        <div class="logo-div">
            <img src="/CGA101G1/frontend/mainCss/images/logo.png" alt="">
            <a href="#" class="logo">帕Game</a>
        </div>


        <nav class="navbar">
            <!-- 上方標籤列 -->
            <a class="active" href="#home">首頁</a>
            <a href="#pd_review" class="nav-link">遊戲新聞</a>
            <a href="#pd_description" class="nav-link">遊戲商城</a>
            <a href="/CGA101G1/frontend/bid/listallbid.html" class="nav-link">二手競標商城</a>
            <a href="#pd_review" class="nav-link">遊戲討論區</a>
        </nav>

        <div class="icons">
            <!--右上方小icon區-->
            <i class="fas fa-bars" id="menu-bars"></i>
            <i class="fas fa-solid fa-user-astronaut" id="login-icon"></i>
            <i class="fas fa-search" id="search-icon"></i>
            <a href="#" class="fas fa-heart"></a>
            <a href="#" class="fas fa-shopping-cart" id="cart"></a>
        </div>

    </header>

    <!-- header section ends-->

    <!--Login starts-->

    <div action="" id="login-form">
        <i class="fas fa-times" id="login-close"></i>


        <div class="form-box">
            <div class="button-box">
                <div id="btn"></div>
                <button type="button" class="toggle-btn" onclick="login()">Log in</button>
                <button type="button" class="toggle-btn" onclick="register()">Register</button>
            </div>

            <form id="login" class="input-group">
                <div class="input-div">
                    <i class="fas fa-solid fa-user-astronaut"></i>
                    <input type="text" class="input-field" placeholder="Username" required>
                </div>
                <div class="input-div">
                    <i class="fas fa-solid fa-lock"></i>
                    <input type="password" class="input-field" placeholder="Password" required>
                </div>

                <div class="others">
                    <input type="checkbox" class="check-box">
                    <span>Remeber Password</span>
                </div>

                <button type="submit" class="submit-btn">Log in</button>
            </form>

            <form id="register" class="input-group">
                <div class="input-div">
                    <i class="fas fa-solid fa-user-astronaut"></i>
                    <input type="text" class="input-field" placeholder="Username" required>
                </div>
                <div class="input-div">
                    <i class="fas fa-solid fa-envelope"></i>
                    <input type="email" class="input-field" placeholder="E-mail" required>
                </div>
                <div class="input-div">
                    <i class="fas fa-solid fa-lock"></i>
                    <input type="password" class="input-field" placeholder="Password" required>
                </div>

                <div class="others">
                    <input type="checkbox" class="check-box">
                    <span>I agree to the terms & conditions</span>
                </div>

                <button type="submit" class="submit-btn">Register</button>
            </form>

        </div>

    </div>

    <!-- Login ends -->

    <!-- search form starts-->

    <form action="" id="search-form">
        <div class="search-group">

            <div>
                <input type="search" placeholder="search here..." name="" id="search-box">
                <input type="button" id="advanced" value="&#x21FE;Advanced search">
                <!-- <a href="#" id="advanced">&#x21FE;Advanced search</a> -->
            </div>
            <label for="search-box" class="fas fa-search"></label>

        </div>


        <i class="fas fa-times" id="search-close"></i>
    </form>

    <!-- search form ends-->

    <!-- advanced search form starts -->

    <form action="" id="advanced-search-form">

        <i class="fas fa-times" id="advanced-search-close"></i>

        <div id="search-select">
            <div class="search-type">
                <span class="list-title">Condition</span>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="check" class="check" value="PS5">
                        <span>New </span>
                    </label>
                    <label>
                        <input type="checkbox" id="check2" class="check" value="Nintendo Switch">
                        <span>Used </span>
                    </label>
                </div>
            </div>

            <div class="search-type">
                <span class="list-title">Platforms</span>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="check" class="check" value="PS5">
                        <span>PS5 </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check2" class="check" value="Nintendo Switch">
                        <span>Nintendo Switch </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check3" class="check" value="Nintendo Switch">
                        <span>Xbox </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check4" class="check" value="PS5">
                        <span>PS4 </span>
                    </label>

                </div>
            </div>

            <div class="search-type">
                <span class="list-title">Items Type</span>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="check" class="check" value="PS5">
                        <span>Game Software </span>
                    </label>
                    <label>
                        <input type="checkbox" id="check2" class="check" value="Nintendo Switch">
                        <span>Hardware </span>
                    </label>
                    <label>
                        <input type="checkbox" id="check3" class="check" value="Nintendo Switch">
                        <span>Figures </span>
                    </label>

                </div>
            </div>

            <div class="search-type">
                <span class="list-title">Game Type</span>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" id="check" class="check" value="RPG">
                        <span>RPG </span>
                    </label>
                    <label>
                        <input type="checkbox" id="check2" class="check" value="Strategy">
                        <span>Strategy</span>
                    </label>
                    <label>
                        <input type="checkbox" id="check3" class="check" value="Gal-Game">
                        <span>Gal-Game </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check4" class="check" value="FPS">
                        <span>FPS </span>
                    </label>
                    <label>
                        <input type="checkbox" id="check9" class="check" value="Simulation">
                        <span>Simulation </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check6" class="check" value="Action">
                        <span>Action </span>
                    </label>

                    <label>
                        <input type="checkbox" id="check7" class="check" value="Adventure">
                        <span>Adventure </span>
                    </label>

                </div>
            </div>

        </div>

        <div class="advanced-btn-group">
            <div>
                <input type="button" class="advanced-reset" value="&#x21BA;Reset">
            </div>
            <div>
                <!-- <i class="fas fa-solid fa-rocket"></i> -->
                <button type="submit"><i class="fas fa-solid fa-rocket"></i>Submit</button>
                <!-- <input type="button" class="advanced-submit" value="&#x21C0;Submit"> -->
            </div>


        </div>



    </form>


    <!-- advanced search form ends -->

    <!-- shopping-cart div starts -->
    <div id="shopping-cart">
        <span>Monopoly</span>
    </div>
    <!-- shopping-cart div ends -->

    <!-- home section starts-->
    <!-- ▼關掉橫幅區▼ -->
    <!-- <section class="home" id="home">

        <div class="swiper home-slider">

            <div class="swiper-wrapper wrapper">

                <div class="swiper-slide slide">
                    <div class="content">
                        <span>our special dish</span>
                        <h3>spicy Xbox</h3>
                        <p>Lorem ipsum dolor sit amet.</p>
                        <a href="#" class="btn">order now</a>
                    </div>
                    <div class="image">
                        <img src=".\\images\\Xbox.png" alt="PS5">
                    </div>
                </div>

                <div class="swiper-slide slide">
                    <div class="content">
                        <span>our special dish</span>
                        <h3>sweet switch</h3>
                        <p>Lorem ipsum dolor sit amet consectetur adipisicing.</p>
                        <a href="#" class="btn">order now</a>
                    </div>
                    <div class="image">
                        <img src=".\\images\\Switch.png" alt="PS5">
                    </div>
                </div>

                <div class="swiper-slide slide">
                    <div class="content">
                        <span>our special dish</span>
                        <h3>Black PS4</h3>
                        <p>Lorem ipsum, dolor sit amet consectetur adipisicing elit.</p>
                        <a href="#" class="btn">order now</a>
                    </div>
                    <div class="image">
                        <img src=".\\images\\PS4.png" alt="PS5">
                    </div>
                </div>

            </div>

            <div class="swiper-pagination"></div>
        </div>

    </section> -->
    <!-- home section ends-->
    <!-- Main -->
    <main>
        <!-- Breadcrumb -->
        <div class="py-3 bg-gray-100">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-6 my-2">
                        <h1 class="m-0 h4 text-center text-lg-start">Shop</h1>
                    </div>
                    <div class="col-lg-6 my-2">
                        <ol class="breadcrumb dark-link m-0 small justify-content-center justify-content-lg-end">
                            <li class="breadcrumb-item"><a class="text-nowrap" href="index.html"><i
                                        class="bi bi-home"></i>Home</a></li>
                            <li class="breadcrumb-item text-nowrap active" aria-current="page">Product</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Breadcrumb -->
        <!-- Product Details -->
        <section class="product-details py-6">
            <div class="container">
                <div class="row align-items-start">
                    <!-- Product Gallery 在col-lg-6刪掉sticky-lg-top -->
                    <div class="col-lg-6 lightbox-gallery product-gallery ">

                        <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-indicators">
                              <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                              <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
                              <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
                            </div>
                            <div class="carousel-inner" id="mainImg">
                              <!-- <div class="carousel-item active">
                                <img src="/CGA101G1/bid/bidPicGetOneByProdPicNo?bidProdPicNo=32001" class="d-block w-100" alt="...">
                              </div>
                              <div class="carousel-item">
                                <img src="/CGA101G1/bid/bidPicGetOneByProdPicNo?bidProdPicNo=32002" class="d-block w-100" alt="...">
                              </div>
                              <div class="carousel-item">
                                <img src="/CGA101G1/bid/bidPicGetOneByProdPicNo?bidProdPicNo=32003" class="d-block w-100" alt="...">
                              </div> -->
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
                              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Previous</span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
                              <span class="carousel-control-next-icon" aria-hidden="true"></span>
                              <span class="visually-hidden">Next</span>
                            </button>
                          </div>

                    </div>
                    <!-- End Product Gallery -->
                    <!-- Product Details  商品內容 -->
                    <div class="col-lg-6 ps-lg-5 pt-5 pt-lg-0" id="mainContent">
                        <!-- <div class="product-detail">
                            <div class="products-brand pb-2">
                                <span>Game Name</span>
                            </div>
                            <div class="products-title mb-2">
                                <h4 class="h4">魔物獵人崛起. モンスターハンターライズ</h4>
                                <h4 class="h4"> Monster hunter Rise</h4>
                            </div>
                            <div class="product-description">
                                <p>為狩獵掀起全新風潮的《魔物獵人》系列最新作品《魔物獵人 崛起》將於 Nintendo Switch 上登場。

                                    獵人們這次可以無拘無束地躍動、隨心所欲地奔馳在原野上。當然還有如怨虎龍、鐮鼬龍王、河童蛙...
                                    等的全新魔物為玩家帶來未知的興奮和驚喜，隨從方面新增「隨從加爾克」可以和熟習的好夥伴 - 艾路搭檔出擊。並且可以透過通訊功能，享受最多四人的協力遊玩。
                                </p>
                            </div> -->

                            <!-- 競標剩餘時間 月份 日期 -->
                            <!-- <p class="products-title mb-2" style="color:#2F365F;">競標剩餘時間</p>
                            <div class="count-down count-down-02 mb-3" data-countdown="4 20, 2022 8:00:00">

                            </div> -->
                            <!-- 購買及價格設定 -->
                            <!-- <div class="product-price fs-3 fw-500 mb-2">
                                <del class="text-muted fs-6">起標價：$500</del>
                                <br>
                                <span class="text-primary">目前出價：$550</span>
                                <br>
                                <span class="text-primary">最低出價增額：$50</span>
                            </div> -->
                            <!-- 加入購物車 -->
                            <!-- <div class="product-detail-actions d-flex flex-wrap pt-3">
                                <div class="cart-qty me-3 mb-3">
                                    <div class="dec qty-btn">-</div>
                                    <input class="cart-qty-input form-control" type="text" name="qtybutton" value="1">
                                    <div class="inc qty-btn">+</div>
                                </div>
                                <div class="cart-button mb-3 d-flex">
                                    <a href="shopping-cart.html" class="btn btn-dark me-3">
                                        <i class="bi bi-cart"></i>
                                        直接出價
                                    </a>
                                </div>
                            </div> -->
                            <!-- 購買跟問問題 -->
                            <!-- <div class="product-info-buttons nav pt-4">
                                <a href="javascript:void(0);" class="" data-bs-toggle="modal"
                                    data-bs-target="#px_shipping_modal"><i class="bi bi-truck me-2"></i>Shipping</a>
                            </div> -->
                            <!-- 商品的分類 -->
                            <!-- <div class="pt-3 border-top mt-3 small">
                                <p class="theme-link mb-2">
                                    <label class="m-0 text-dark">支援平台:</label>
                                    <a href="javascript:void(0);">Nintendo Switch</a>
                                </p>
                                <p class="theme-link mb-2">
                                    <label class="m-0 text-dark">遊戲種類:</label>
                                    <a href="javascript:void(0);">多人對戰</a>
                                </p> -->
                                <!-- 商品的tag -->
                                <!-- <p class="theme-link mb-2">
                                    <label class="m-0 text-dark">遊戲公司:</label>
                                    <a href="javascript:void(0);">Nintendo</a>
                                </p>
                            </div>
                            <div class="pt-4">
                                <img class="img-fluid" src="assets/img/payment-details.png" title="" alt="">
                            </div>

                        </div> -->
                    </div>
                    <!-- End Product Details -->
                </div>
            </div>
        </section>
        <!-- End Product Details -->

    </main>
    <!-- End Main -->

    <!-- Footer -->
    <footer class="bg-white footer">
        <div class="footer-top py-6">
            <div class="container">
                <div class="row">
                    <section class="footer">
                        <div class="box-container">
                            <div class="box">
                                <h3>會員專區</h3>
                                <a href="#">會員登入</a>
                                <a href="#">會員註冊</a>
                                <a href="#">訂單管理</a>
                                <a href="#">二手遊戲申請上架單管理</a>
                            </div>
                
                            <div class="box">
                                <h3>快速連結</h3>
                                <a href="#">首頁</a>
                                <a href="#">遊戲商城</a>
                                <a href="#">二手競標商城</a>
                                <a href="#">遊戲討論區</a>
                            </div>
                
                            <div class="box">
                                <h3>聯絡我們</h3>
                                <a href="#">02-3456-7890</a>
                                <a href="#">03-1111-2222</a>
                                <a href="#">CGA101G1@gmail.com</a>
                                <a href="#">anasbhai@gmail.com</a>
                            </div>
                
                            <div class="box">
                                <h3>關於我們</h3>
                                <a href="#">管理團隊</a>
                                <a href="#">創始理念</a>
                                <a href="#">insuagram</a>
                                <a href="#">linkedin</a>
                            </div>
                        </div>
                
                        <div class="credit">copyright@2022 by <span>CGA101G1</span></div>
                
                    </section>
                </div>
            </div>
        </div>

    </footer>
    <!-- End Footer -->
    <script src ="http://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.js"></script>

    <script src="https://cdn.bootcdn.net/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>

    <script>
        let queryString = window.location.search;
        let urlParams = new URLSearchParams(queryString);
        let bidProductNo = urlParams.get("bidProductNo");
    
        $.ajax({
            url: `/CGA101G1/bid/bidProductGetOne?bidProductNo=${bidProductNo}`,
            type: "POST",
            success: function(data){
                showOneBid(data);
            }
        })

        function showOneBid(data){
        let all = JSON.parse(data);
        let bidProductVO = all.bidProductVO;
        let bidRecordVO = all.bidRecordVO;
        let productVO = all.productVO;
        let gameTypeVO = all.gameTypeVO;
        let gamePlatformTypeVO = all.gamePlatformTypeVO;
        let gameCompanyVO = all.gameCompanyVO;
        let bidPrice = "目前尚未有出價紀錄";

        let bidLaunchedTime = moment(bidProductVO.bidLaunchedTime).format('YYYY-MM-DD HH:mm:ss');
        let bidSoldTime = moment(bidProductVO.bidSoldTime).format('YYYY-MM-DD HH:mm:ss');

        let div = document.querySelector("#mainContent");
        div.innerHTML=`
                        <div class="product-detail">
                            <div class="products-brand pb-2">
                                <span>Game Name</span>
                            </div>
                            <div class="products-title mb-2">
                                <h4 class="h4">${bidProductVO.bidName}</h4>
                            </div>
                            <div class="product-description">
                                <p>${bidProductVO.bidProdDescription}</p>
                            </div>

                            <!-- 競標剩餘時間 月份 日期 -->
                            <p class="products-title mb-2" style="color:#2F365F;">競標剩餘時間</p>
                            <div class="count-down count-down-02 mb-3" data-countdown="${bidProductVO.bidSoldTime}">

                            </div>
                            <!-- 購買及價格設定 -->
                            <div class="product-price fs-3 fw-500 mb-2">
                                <span class="text-primary" id="initialPrice">起標價：$ <span id="initialPriceSpan">${bidProductVO.initialPrice}</span></span>
                                <br>
                                <span class="text-primary" id="nowPrice">目前出價：$ <span id="bidPirceSpan">${bidPrice}</span></span>
                                <br>
                                <span class="text-primary">最低出價增額：$ <span id="bidPriceIncrementSpan">${bidProductVO.bidPriceIncrement}</span></span>
                                <br>
                                <span class="text-primary">開始時間：${bidLaunchedTime}</span>
                                <br>
                                <span class="text-primary">結束時間：${bidSoldTime}</span>
                            </div>
                            <!-- 加入購物車 -->
                            <div class="product-detail-actions d-flex flex-wrap pt-3">
                                <div class="cart-qty me-3 mb-3">
                                    <div class="dec qty-btn">-</div>
                                    <input class="cart-qty-input form-control" type="text" name="qtybutton" id="bidInput" value="1">
                                    <div class="inc qty-btn">+</div>
                                </div>
                                <div class="cart-button mb-3 d-flex">
                                    <button class="btn btn-dark me-3" id="bidSubmit">
                                        直接出價
                                    </button>
                                    <button class="btn btn-danger me-3" id="productSubmit">
                                        跳轉一手商品
                                    </button>
                                </div>
                            </div>
                            <!-- 恭喜xxx得標的部分 -->
                            <div class="product-info-buttons nav pt-4" style = "font-size:1.5rem; color:red;"id="congratulation">

                            </div>
                            <!-- 商品的分類 -->
                            <div class="pt-3 border-top mt-3 small">
                                <p class="theme-link mb-3">
                                    <label class="m-0 text-dark" style="font-size:1.5rem;">支援平台:  ${gamePlatformTypeVO.gamePlatformName}</label>
                                    
                                </p>
                                <p class="theme-link mb-3">
                                    <label class="m-0 text-dark" style="font-size:1.5rem;">遊戲種類:  ${gameTypeVO.gameTypeName}</label>
                                    
                                </p>
                                <!-- 商品的tag -->
                                <p class="theme-link mb-3">
                                    <label class="m-0 text-dark" style="font-size:1.5rem;">遊戲公司:  ${gameCompanyVO.gameCompanyName}</label>
                                </p>
                            </div>
                            <div class="pt-4">
                                <img class="img-fluid" src="assets/img/payment-details.png" title="" alt="">
                            </div>

                        </div>
                    `;
        // 動態產生現在最高出價者

        if(bidRecordVO){
            bidPrice = bidRecordVO.bidPrice;
            let congratulation = document.querySelector("#congratulation");
            congratulation.innerHTML = `目前最高出價為：${bidRecordVO.memNo}`;
        }

        // 時間倒數

            var $count_timer = $('.count-down');
            var regionalVar = { days: 'Days', day: 'Day', years: 'Years', year: 'Year', hours: 'Hours', hour: 'Hour', minutes: 'Minutes', minute: 'Minute', seconds: 'Seconds', second: 'Second' };
            if ($count_timer.length > 0) {
                $('.count-down').countdown({ regional: regionalVar });
            }
            let now = moment().valueOf();

        // 判斷直接出價按鈕是否可按

            if(Date.parse(bidProductVO.bidSoldTime)< now){
                setInterval(() => {
                    document.querySelector(".count-down").innerHTML=`<div class="mb-3" style="font-size:2rem">已結束</div>`
                    document.querySelector("#bidSubmit").disabled="disabled";
                }, 1000);
            }

        // 送出按鈕監聽出價及更新
            let bidSubmit = document.getElementById("bidSubmit");
            bidSubmit.addEventListener("click",send);

        // 一手商品跳轉
            if(productVO){
                productUpc = productVO.upcNum;
                let productSubmit = document.querySelector("#productSubmit");
                productSubmit.addEventListener("click",function(){
                    window.location=`/CGA101G1/frontend/Product/HomePageinProduct.html?ProductNo=${productVO.productNo}`;
                })
            }else{
                let productSubmit = document.querySelector("#productSubmit");
                productSubmit.classList.remove("btn-danger");
                productSubmit.classList.add("btn-dark");
                productSubmit.disabled="disabled";
            }

        // 得標恭喜
            if(bidProductVO.buyerNo){
                document.querySelector("#congratulation").innerHTML=`恭喜 ${bidProductVO.buyerNo} 會員得標`;
            }
        }

$.ajax({
        url:`/CGA101G1/bid/bidPicGetAll?bidProductNo=${bidProductNo}`,
        type:"POST",
        success:function(data){
        	showAllPic(data);
        }
    })

function showAllPic(data){
	let pics = JSON.parse(data);
    let div = document.querySelector("#mainImg");
	let bidProdPicHTML = "";
    bidProdPicHTML += `
        <div class="carousel-item active">
            <img src="/CGA101G1/bid/bidPicGetOneByProdPicNo?bidProdPicNo=${pics[0].bidProdPicNo}" class="d-block w-100" alt="...">
        </div>
        `;
		for (let i = 1; i < pics.length; i++) {
			bidProdPicHTML += `
            <div class="carousel-item">
                <img src="/CGA101G1/bid/bidPicGetOneByProdPicNo?bidProdPicNo=${pics[i].bidProdPicNo}" class="d-block w-100" alt="...">
            </div>
			`;
		}
	div.innerHTML=bidProdPicHTML;
}

// WebSocket 競標價格即時更新
var websocket = null;
//判斷當前瀏覽器是否支援WebSocket
if ('WebSocket' in window) {
    let host = window.location.host;
    let path = window.location.pathname;
	let webCtx = path.substring(0, path.indexOf('/', 1));
    websocket = new WebSocket(`ws://${host}${webCtx}/bid/webSocket/${bidProductNo}`);
} else {
    alert('當前瀏覽器 Not support websocket')
}
//連線發生錯誤的回撥方法
websocket.onerror = function() {
    console.log("WebSocket連線發生錯誤");
};
//連線成功建立的回撥方法
websocket.onopen = function() {
    console.log("WebSocket連線成功");
}
//接收到訊息的回撥方法
websocket.onmessage = function(event) {
    let bidRecordVOs = JSON.parse(event.data);
    let bidPirceSpan = document.querySelector("#bidPirceSpan");
    let congratulation = document.querySelector("#congratulation");
    for(bidr of bidRecordVOs){
        if (bidr.bidProductNo == bidProductNo){
            bidPirceSpan.innerHTML = bidr.bidPrice;
            congratulation.innerHTML = `目前最高出價為：${bidr.memNo}`;
        }
    }
}
//連線關閉的回撥方法
websocket.onclose = function() {
    console.log("WebSocket連線關閉");
}
//監聽視窗關閉事件，當視窗關閉時，主動去關閉websocket連線，防止連線還沒斷開就關閉視窗，server端會拋異常。
window.onbeforeunload = function() {
    closeWebSocket();
}
//將訊息顯示在網頁上
function setMessageInnerHTML(innerHTML) {
}
//關閉WebSocket連線
function closeWebSocket() {
    websocket.close();
}
//傳送訊息
function send(event) {
    $.ajax({
                url: `/CGA101G1/bid/bidRecordGetSession?bidProductNo=${bidProductNo}`,
                type: "POST",
                success: function(data){
                    checkLogin(data);
                }
            })

}

// 檢驗登入
function checkLogin(data){
    let memNo = data;
    console.log(memNo);
    if(memNo==="0"){
        // window.alert("請先登錄");
        swal("登入狀態錯誤","請先登入!","error").then(function () {
        window.location="/CGA101G1/frontend/mem/login.html";
        })
    return;
    }
    let bidInput = document.querySelector("#bidInput").value;
    let bidPirceSpan = document.querySelector("#bidPirceSpan").innerHTML;
    let bidPriceIncrementSpan = document.querySelector("#bidPriceIncrementSpan").innerHTML;
    let bidinitialPriceSpan = document.querySelector("#initialPriceSpan").innerHTML;

    let bidPrice = isNaN(bidPirceSpan) ? bidinitialPriceSpan : bidPirceSpan;

    if ( bidInput < +bidPrice+(+bidPriceIncrementSpan) ){
        window.alert("出價請大於最低出價要求");
    }else{
        let message = {
            memNo:memNo,
            bidPrice:bidInput
        }
        let json = JSON.stringify(message);
        websocket.send(json);
    }


}

</script>

    <script src="https://unpkg.com/swiper@8/swiper-bundle.min.js"></script>
    <!-- 外來區 -->
    <!-- jquery -->
    <script src="/CGA101G1/frontend/mainCss/assets/js/jquery-3.5.1.min.js"></script>
    <!-- appear -->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/appear/jquery.appear.js"></script>
    <!--bootstrap-->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- owl-carousel -->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/slick/slick.min.js"></script>
    <!-- magnific -->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/magnific/jquery.magnific-popup.min.js"></script>
    <!-- isotope -->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/isotope/isotope.pkgd.min.js"></script>
    <!-- count-down -->
    <script src="/CGA101G1/frontend/mainCss/assets/vendor/count-down/jquery.countdown.min.js"></script>
    <!-- Theme Js -->
    <script src="/CGA101G1/frontend/mainCss/assets/js/custom.js"></script>
    <!-- 外來區over -->
    <!-- custom js file link-->
    <script src="/CGA101G1/frontend/mainCss/js/script.js"></script>
</body>

</html>